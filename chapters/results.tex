\definecolor{borderrect}{HTML}{1E5162}
\definecolor{inrect}{HTML}{67B7D1}

\فصل{نتایج}
\قسمت{مقایسه‌ی مدل‌ها}
در این فصل، نخست نتیجه مقایسه مدل‌ها را بیان می‌کنیم. برای آموزش و تست مدل‌ها، در ابتدا 
$80\%$
داده‌ها در دسته‌ی داده‌های آموزش و اعتبارسنجی و
$20\%$
داده‌ها در دسته‌ی داده‌های تست قرار گرفته‌اند. تمامی مدل‌های ارائه شده در فصل قبل با روش اعتبارسنجی متقابل \lr{$k$-fold} \پانویس{$k$-fold cross validation} آموزش دیده‌اند و بهترین مجموعه‌ی ابرپارامترها برای آن‌ها پیدا شده است.

\begin{table}[t]
		\شرح{کارایی مدل‌ها روی داده‌های بیماران. امتیاز تجمیعی Berier در یک بازه‌ی ۵ ساله محاسبه شده است. همه‌ی اعداد با دو رقم اعشار گرد شده‌اند. در مدل‌های شبکه‌ی عصبی، در خط دوم، دقت روی داده‌ی اعتبارسنجی مشاهده می‌شود.}
	\begin{latin}
	\centering
	\begin{tabular}{|c|cc|cc|}
		\hline
		\\[-1em]
		\multirow{2}{*}{Model} & \multicolumn{2}{c|}{Train} & \multicolumn{2}{c|}{Test} \\
		& C-index & IBS & C-index & IBS \\
		\hline
		\\[-1em]
		RSF & 0.89 & 0.06 & \textbf{0.84} & 0.11 \\
		\hline
		GBS & 0.92 & 0.05 & 0.82 & 0.11 \\
		\hline
		Cox PH & 0.79 & 0.12 & 0.78 & 0.15 \\
		\hline
		\multirow{2}{*}{Logistic Hazard} & 0.89 & 0.07 & \multirow{2}{*}{\textbf{0.87}} & \multirow{2}{*}{0.10}\\
		& 0.85 & 0.10 & & \\
		\hline
		\multirow{2}{*}{DeepSurv} & 0.93 & 0.04 & \multirow{2}{*}{0.82} & \multirow{2}{*}{0.10}\\
		& 0.80 & 0.11 & & \\
		\hline
		\multirow{2}{*}{PC Hazard} & 0.81 & 0.10 & \multirow{2}{*}{0.78} & \multirow{2}{*}{0.12}\\
		& 0.77 & 0.13 & & \\
		\hline
		
	\end{tabular}
\end{latin}
	\برچسب{جدول:نتایج‌مدل‌ها}
\end{table}

نتیجه‌ی آموزش مدل‌ها روی مجموعه‌ی داده‌هایمان با بهترین ابرپارامترها در جدول~\رجوع{جدول:نتایج‌مدل‌ها} قابل مشاهده است. همانطور که مشاهده می‌شود، مدل \lr{Logistic Hazard}، بهترین نتیجه را در میان تمامی مدل‌ها دارد و بالاترین دقت روی داده‌ی تست را در معیار $C_{index}$ به خود اختصاص می‌دهد. البته مدل جنگل بقای تصادفی هم دقت قابل توجهی دارد. مدل کلاسیک \lr{Cox-PH} هم همانطور که انتظار می‌رفت، دقت نسبتاً پایین‌تری نسبت به باقی مدل‌ها دارد و سادگی مدل سبب می‌شود که نتواند دقت قابل قبولی روی داده‌ی آموزش یا تست به دست بیاورد. در میان مدل‌های مبتنی بر شبکه‌ی عصبی که عموماً در حجم بالای داده خیلی خوب عمل می‌کنند، مدل \lr{Logisitc Hazard} بهتر از بقیه عمل می‌کند و دقت به مراتب بهتری دارد. به همین جهت ما نیز از این مدل برای انتخاب ویژگی‌ها و تعیین اهمیت آن‌ها استفاده می‌کنیم.

همانطور که بیان شد، این مدل‌ها می‌توانستند تابع خطر و بعد از روی آن تابع بقا را پیش‌بینی کنند. تابع بقای پیش‌بینی شده برای $10$ مورد از بیماران توسط دو مدل جنگل بقای تصادفی و \lr{Logistic Hazard} در شکل~\رجوع{شکل:تابع‌بقای‌پیش‌بینی‌شده} قابل مشاهده است. همانطور که مشاهده می‌شود، در هر دو این توابع، نفرات شماره‌ی $2$، $3$، $7$ و $8$ نفراتی هستند که در خطر بوده و تابع بقا برای آن‌ها به سرعت کاهش می‌یابد. در سمت مقابل، بیماران با شماره‌های $1$ و $5$ وجود دارند که به مراتب مطابق با پیش‌بینی هر دو مدل کمتر در خطر بوده و احتمالاً طولانی‌تر زنده خواهند ماند.

\pgfplotsset{%
	,compat=1.12
	,every axis x label/.style={at={(axis description cs:0.5,-0.1)},anchor=north}
	,every axis y label/.style={at={(current axis.above origin)},anchor=north east}
}
\شروع{شکل}
[t]\centering
\input{figs/surv-plots}
\شرح{تابع بقا؛ پیش‌بینی شده توسط دو مدل جنگل بقای تصادفی و \lr{Logistic Hazard}. این دو نمودار، تابع $S(t|x)$ را برای $10$ بیمار نشان می‌دهند. بیماران پر خطر و کم‌خطر در هر دو نمودار تقریباً یکسان هستند.}
\برچسب{شکل:تابع‌بقای‌پیش‌بینی‌شده}
\پایان{شکل}

\شروع{شکل}
[t]\centering
\input{figs/rsf-gbs-feature-importance}
\شرح{اهمیت ویژگی‌ها در مدل‌های جنگل بقا و ماشین تقویت گرادیان}
\برچسب{شکل:اهمیت فیچرها جنگل بقا و ماشین تقویت گرادیان}
\پایان{شکل}

\قسمت{اهمیت ویژگی‌ها}
دو مدل جنگل بقای تصادفی و ماشین تقویت گرادیان، هر دو به خاطر ساختاری که دارند می‌توانند اهمیت ویژگی‌ها را به دست بیاورند. در مدل جنگل بقا، برای تعیین اهمیت یک ویژگی، هر جا داخل درخت‌های تصمیم، بچه‌های یک گره بر اساس آن ویژگی جدا شده‌اند، مرز جداشدن به شکل تصادفی تعیین می‌شود و نهایتاً‌ میزان خطای پیش‌بینی \پانویس{Prediction Error} سنجیده می‌شود. هر چه خطا بیشتر شود، یعنی ویژگی‌ پراهمیت‌تر بوده است. مدل ماشین تقویت گرادیان هم به شکل مشابه چنین قابلیتی را دارد. اهمیت ویژگی‌ها در شکل~\رجوع{شکل:اهمیت فیچرها جنگل بقا و ماشین تقویت گرادیان} قابل مشاهده است. این شکل به ما نشان می‌دهد که ویژگی‌هایی از قبیل سن، زمان عود، سایز تومور و  جراحی ویژگی‌های پر اهمیت در هر دو مدل‌ها هستند. همچنین پرتو‌درمانی و شیمی‌درمانی ویژگی‌هایی هستند که به ترتیب در ماشین تقویت گرادیان و جنگل بقا مهم بوده‌اند.

\شروع{شکل}
[t]\centering
\input{figs/feature-importance-semi-exhaustive}
\شرح{احتمال اینکه یک ویژگی در یک مجموعه‌ی امیدبخش باشد؛ نتیجه‌ی آزمایش روی~$1000$ مجموعه‌‌ی~$15$~عضوی از ویژگی‌ها. هر چه این احتمال بزرگتر باشد، یعنی ویژگی مهم‌تر است و با نبودنش، احتمالاً مجموعه‌ی ویژگی‌ها امیدبخش نیستند.}
\برچسب{شکل:اهمیت فیچرها نیمه کامل}
\پایان{شکل}

در مورد مدل \lr{Logistic Hazard}، همانطور که در فصل پیشین مطرح شد، مجموعه آزمایشات جستجوی کامل و جستجوی نیمه‌کامل انجام شد. در مورد جستجوی نیمه‌کامل، هر مجموعه‌ی $15$‌تایی از ویژگی‌ها که بتواند دقت $C_{index}$ حداقل $0.835$ داشته باشد را در نظر می‌گیریم و آن‌ها را مجموعه‌های \textbf{امیدبخش} می‌نامیم. شکل~\رجوع{شکل:توزیع‌جستجو‌ها} توزیع مقدار $C_{index}$ در مجموعه‌های تصادفی مورد آزمایش را نشان می‌دهد. 
سپس برای هر ویژگی‌، حساب می‌کنیم که در چه کسری از این مجموعه‌های امیدبخش وجود دارد. طبیعتاً هر چه این کسر برای یک ویژگی بزرگتر باشد، به نوعی نشان می‌دهد که این ویژگی مهم است و اگر در مجموعه‌ی داده‌ها ظاهر شود، می‌تواند سبب تقویت دقت مدل شود و برعکس اگر ظاهر نشود، مدل با احتمال کمی می‌تواند دقت قابل قبولی داشته باشد. پس بدین ترتیب می‌توانیم تخمینی بر اهمیت ویژگی‌ها داشته باشیم.
شکل~\رجوع{شکل:اهمیت فیچرها نیمه کامل} این کسر را برای ویژگی‌های مختلف نشان می‌دهد. در آزمایشات ما و در مدل \lr{Logistic Hazard}، به نظر می‌رسد سن، زمان عود، شیمی درمانی، سایز تومور و جراحی ویژگی‌های تاثیر‌گذار در پیش‌بینی بقا هستند.

در مورد جستجوی کامل، کاری دقیقاً مشابه بالا انجام شد. توزیع $C_{index}$ در مجموعه‌ی آزمایشات مطابق با شکل~\رجوع{شکل:توزیع‌جستجو‌ها} است. مجدداً برای هر ویژگی احتمال اینکه در یک مجموعه‌ی \textbf{امیدبخش} (در اینجا مجموعه‌ی امیدبخش دقت حداقل $0.83$ در $C_{index}$ دارد) باشد را حساب می‌کنیم. نتیجه محاسبه‌ی این کسر در شکل\رجوع{شکل:اهمیت فیچرها کامل} مشاهده می‌شود. نتایج این آزمایش هم تقریباً‌ سازگار با آزمایشات قبلی است و می‌توان متوجه شد که مثلاً‌ ویژگی‌هایی مثل سن، زمان عود، شیمی‌درمانی و جراحی در آنالیز بقا در مورد بیماران ما حائز اهمیت هستند.



\شروع{شکل}
[b]\centering
\input{figs/feature-importance-exhaustive}
\شرح{احتمال اینکه یک ویژگی در یک مجموعه‌ی امیدبخش باشد؛ آزمایش روی $210$ مجموعه‌‌ی $19$~عضوی از ویژگی‌ها. مقادیر جدول بالا منهای‌ $\frac{19}{21}$ شده‌اند چون هر ویژگی‌ای در $\frac{19}{21}$ نمونه‌ها وجود دارد. هر چه این احتمال بزرگتر باشد، یعنی ویژگی مهم‌تر است و با نبودنش، احتمالاً مجموعه‌ی ویژگی‌ها امیدبخش نیستند.}

\برچسب{شکل:اهمیت فیچرها کامل}
\پایان{شکل}

\قسمت{جمع‌بندی}
در این فصل مدل‌هایی که در فصل قبل معرفی کردیم را روی داده‌هایمان بررسی کردیم و به مقایسه آن‌ها پرداختیم. همچنین اهمیت ویژگی‌ها را مورد بررسی قرار دادیم و برای سه تا از مدل‌ها، ویژگی‌هایی که اهمیت بیشتری در پیش‌بینی بقا دارند را شناسایی کردیم.